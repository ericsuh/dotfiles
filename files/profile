# History settings
shopt -s histappend # append, don't overwrite history
export PROMPT_COMMAND='history -a' #write history when displaying prompt
export LC_CTYPE=en_US.UTF-8 # For possible non-ASCII filenames

# Coloration of Command Prompt and 'ls'
# includes magic sequence \033k\033\\ at beginning
# for the purposes of `screen` and \033[7h
# to allow for good line wrapping
export PS1='\[\033k\033\\\033[7h\][\u@\h:\W]$ '
export CLICOLOR=1
export LSCOLORS=BxFxCxDxCxegedabagacad
export EDITOR=vim

export CDPATH=".:${HOME}:${CDPATH}"
export PATH="${HOME}/bin:${PATH}"
export PYTHONSTARTUP="${HOME}/.pythonrc"

LOCAL_PROFILE="${HOME}/.profile_local"
if [ -e ${LOCAL_PROFILE} ]; then
	source ${LOCAL_PROFILE}
fi

export SSH_AUTH_SOCK="$XDG_RUNTIME_DIR/ssh-agent.socket"
export PATH="$HOME/.cargo/bin:/usr/local/go/bin:$PATH"

SSH_ENV="$HOME/.ssh/environment"

function start_agent {
	/usr/bin/ssh-agent | sed 's/^echo/#echo/' > "${SSH_ENV}"
	chmod 600 "${SSH_ENV}"
	. "${SSH_ENV}" > /dev/null
	/usr/bin/ssh-add;
}

# Source SSH settings, if applicable

if [ -f "${SSH_ENV}" ]; then
    . "${SSH_ENV}" > /dev/null
    #ps ${SSH_AGENT_PID} doesn't work under cywgin
	ps -ef | grep ${SSH_AGENT_PID} | grep ssh-agent$ > /dev/null || {
		start_agent;
	}
else
    start_agent;
fi
